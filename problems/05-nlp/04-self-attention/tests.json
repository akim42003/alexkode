{
    "function": "solution",
    "test_cases": [
        {
            "name": "identity Q=K=V",
            "input": {"Q": [[1, 0], [0, 1]], "K": [[1, 0], [0, 1]], "V": [[1, 0], [0, 1]]},
            "expected": {"output_shape": [2, 2]}
        },
        {
            "name": "single token",
            "input": {"Q": [[1, 2]], "K": [[1, 2]], "V": [[3, 4]]},
            "expected": [[3.0, 4.0]]
        },
        {
            "name": "two tokens equal Q K",
            "input": {"Q": [[1, 0], [1, 0]], "K": [[1, 0], [1, 0]], "V": [[1, 0], [0, 1]]},
            "expected": [[0.5, 0.5], [0.5, 0.5]]
        },
        {
            "name": "3 tokens output shape",
            "input": {"Q": [[1, 0, 0], [0, 1, 0], [0, 0, 1]], "K": [[1, 0, 0], [0, 1, 0], [0, 0, 1]], "V": [[1, 2, 3], [4, 5, 6], [7, 8, 9]]},
            "expected": {"output_shape": [3, 3]}
        },
        {
            "name": "attention weights sum to 1",
            "input": {"Q": [[1, 0], [0, 1]], "K": [[1, 0], [0, 1]], "V": [[10, 20], [30, 40]]},
            "expected": {"attention_weights_sum": 1.0}
        }
    ]
}
