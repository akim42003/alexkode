{
    "function": "solution",
    "test_cases": [
        {
            "name": "output shape matches input",
            "input": {"X": [[[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0]]], "d_model": 4, "n_heads": 2, "d_ff": 8, "seed": 42},
            "expected": {"output_shape": [1, 3, 4]}
        },
        {
            "name": "single token",
            "input": {"X": [[[1, 2, 3, 4]]], "d_model": 4, "n_heads": 1, "d_ff": 8, "seed": 42},
            "expected": {"output_shape": [1, 1, 4]}
        },
        {
            "name": "batch of 2",
            "input": {"X": [[[1, 0], [0, 1]], [[0, 1], [1, 0]]], "d_model": 2, "n_heads": 1, "d_ff": 4, "seed": 42},
            "expected": {"output_shape": [2, 2, 2]}
        },
        {
            "name": "4 heads",
            "input": {"X": [[[1, 0, 0, 0, 0, 0, 0, 0]]], "d_model": 8, "n_heads": 4, "d_ff": 16, "seed": 42},
            "expected": {"output_shape": [1, 1, 8]}
        }
    ]
}
