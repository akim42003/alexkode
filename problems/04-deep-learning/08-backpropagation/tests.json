{
    "function": "solution",
    "test_cases": [
        {
            "name": "gradient shapes correct",
            "input": {"X": [[1.0, 0.0], [0.0, 1.0]], "y": [[1, 0], [0, 1]], "layer_dims": [2, 3, 2], "activations": ["relu", "softmax"]},
            "expected": {"dW_shapes": [[2, 3], [3, 2]], "db_shapes": [3, 2]}
        },
        {
            "name": "training reduces loss",
            "input": {"X": [[0, 0], [0, 1], [1, 0], [1, 1]], "y": [[1, 0], [0, 1], [0, 1], [1, 0]], "layer_dims": [2, 8, 2], "activations": ["relu", "softmax"], "epochs": 500, "lr": 0.1},
            "expected": {"loss_decreased": true}
        },
        {
            "name": "single sample",
            "input": {"X": [[1.0, 2.0]], "y": [[1, 0]], "layer_dims": [2, 4, 2], "activations": ["relu", "softmax"]},
            "expected": {"dW_shapes": [[2, 4], [4, 2]], "db_shapes": [4, 2]}
        },
        {
            "name": "gradient check passes",
            "input": {"X": [[1.0, 0.5], [0.5, 1.0], [0.0, 0.0]], "y": [[1, 0], [0, 1], [1, 0]], "layer_dims": [2, 4, 2], "activations": ["relu", "softmax"]},
            "expected": {"max_relative_error_below": 0.0001}
        }
    ]
}
